<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé¨ Elite Trading Script Generator V3 - With Image Prompts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            padding: 40px 30px;
            background: rgba(0,0,0,0.4);
            border-radius: 20px;
            border: 2px solid rgba(139,92,246,0.3);
            margin-bottom: 30px;
            animation: glow 2s ease-in-out infinite;
        }
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 30px rgba(139,92,246,0.3); }
            50% { box-shadow: 0 0 50px rgba(139,92,246,0.5); }
        }
        .header h1 {
            font-size: 2.8em;
            background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 50%, #c4b5fd 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            font-weight: 900;
        }
        .subtitle {
            font-size: 1.1em;
            color: #a78bfa;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        .badge-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .badge {
            background: rgba(139,92,246,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85em;
            border: 1px solid rgba(139,92,246,0.4);
        }
        .main-grid {
            display: grid;
            grid-template-columns: 420px 1fr;
            gap: 25px;
        }
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
        .sidebar {
            background: rgba(0,0,0,0.4);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid rgba(139,92,246,0.2);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        .content-panel {
            background: rgba(0,0,0,0.4);
            padding: 35px;
            border-radius: 15px;
            border: 2px solid rgba(139,92,246,0.2);
        }
        .section {
            margin-bottom: 25px;
        }
        .section h3 {
            color: #a78bfa;
            margin-bottom: 15px;
            font-size: 1.15em;
            border-bottom: 2px solid rgba(139,92,246,0.2);
            padding-bottom: 10px;
        }
        .input-group {
            margin-bottom: 18px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #c4b5fd;
            font-size: 0.95em;
        }
        input, textarea {
            width: 100%;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(139,92,246,0.3);
            border-radius: 10px;
            color: white;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s;
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: #8b5cf6;
            background: rgba(139,92,246,0.1);
        }
        input:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        .btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.05em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(139,92,246,0.5);
        }
        .btn:disabled {
            background: #444;
            cursor: not-allowed;
            transform: none;
            opacity: 0.6;
        }
        .info-box {
            background: rgba(139,92,246,0.1);
            border-left: 4px solid #8b5cf6;
            padding: 14px;
            border-radius: 8px;
            font-size: 0.88em;
            margin-top: 10px;
            line-height: 1.6;
        }
        .length-option {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(139,92,246,0.2);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .length-option:hover {
            background: rgba(139,92,246,0.15);
            border-color: #8b5cf6;
        }
        .length-option.selected {
            background: rgba(139,92,246,0.25);
            border-color: #8b5cf6;
            border-width: 3px;
        }
        .length-option input[type="radio"] {
            margin-right: 12px;
            width: auto;
        }
        .length-option label {
            display: inline;
            cursor: pointer;
            margin-bottom: 0;
            font-size: 1.05em;
        }
        .length-details {
            font-size: 0.85em;
            opacity: 0.75;
            margin-top: 6px;
            margin-left: 30px;
        }
        .progress-section {
            display: none;
            margin: 30px 0;
        }
        .progress-bar {
            width: 100%;
            height: 40px;
            background: rgba(0,0,0,0.4);
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 20px;
            border: 2px solid rgba(139,92,246,0.3);
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
        }
        .status {
            background: rgba(0,0,0,0.3);
            padding: 18px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(139,92,246,0.2);
            line-height: 1.7;
        }
        .result-card {
            background: rgba(16,185,129,0.1);
            border: 2px solid #10b981;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            display: none;
        }
        .result-card.show {
            display: block;
            animation: slideIn 0.5s ease;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        @media (max-width: 768px) {
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        .stat-box {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(16,185,129,0.3);
        }
        .stat-number {
            font-size: 2em;
            font-weight: 900;
            color: #10b981;
            display: block;
        }
        .stat-label {
            font-size: 0.85em;
            opacity: 0.8;
            margin-top: 5px;
        }
        .download-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .error-box {
            background: rgba(239,68,68,0.1);
            border: 2px solid #ef4444;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            color: #fca5a5;
            display: none;
        }
        .error-box.show {
            display: block;
        }
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.3);
        }
        ::-webkit-scrollbar-thumb {
            background: #8b5cf6;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé¨ ELITE TRADING SCRIPT GENERATOR V3</h1>
            <p class="subtitle">Gemini 2.5 Flash ‚Ä¢ Maximum Quality Mode ‚Ä¢ Voice-Ready ‚Ä¢ AI Image Prompts</p>
            <div class="badge-row">
                <span class="badge">üé§ Voice Ready</span>
                <span class="badge">üìä Educational Focus</span>
                <span class="badge">üöÄ 3-Part System</span>
                <span class="badge">üíé Ultra High Quality</span>
                <span class="badge">üé® 6 AI Image Prompts</span>
            </div>
        </div>

        <div class="main-grid">
            <div class="sidebar">
                <div class="section">
                    <h3>üîë API Configuration</h3>
                    <div class="input-group">
                        <label>Gemini 2.5 Flash API Key</label>
                        <input type="password" id="apiKey" placeholder="Enter your API key..." />
                    </div>
                    <div class="info-box">
                        <strong>Get Free API:</strong> ai.google.dev<br>
                        <strong>Free Tier:</strong> 15 RPM, 1,500 RPD<br>
                        <strong>This tool:</strong> 4 optimized API calls<br>
                        (3 for script + 1 for image prompts)
                    </div>
                </div>

                <div class="section">
                    <h3>üìè Script Length</h3>
                    <div id="lengthOptions">
                        <div class="length-option" onclick="selectLength(30000, this)">
                            <input type="radio" name="length" id="len30k">
                            <label for="len30k">30K - Medium Script</label>
                            <div class="length-details">~6,500 words ‚Ä¢ 20 min video</div>
                        </div>
                        <div class="length-option selected" onclick="selectLength(60000, this)">
                            <input type="radio" name="length" id="len60k" checked>
                            <label for="len60k">60K - Full Script ‚≠ê</label>
                            <div class="length-details">~13,000 words ‚Ä¢ 45 min video</div>
                        </div>
                        <div class="length-option" onclick="selectLength(100000, this)">
                            <input type="radio" name="length" id="len100k">
                            <label for="len100k">100K - Epic Script üî•</label>
                            <div class="length-details">~22,000 words ‚Ä¢ 70 min video</div>
                        </div>
                    </div>
                    <div class="info-box" id="lengthInfo">
                        Selected: <strong>60K minimum</strong><br>
                        ONE seamless block<br>
                        Maximum quality mode
                    </div>
                </div>

                <div class="section">
                    <h3>üíé Fixed Product</h3>
                    <div class="info-box">
                        <strong>THE 7-FIGURE TRADER'S MIND VAULT</strong><br><br>
                        The Complete Psychology System That Separates The Top 5% From Everyone Else<br><br>
                        ‚úÖ NO price mention (creates mystery)<br>
                        ‚úÖ Massive desire & curiosity<br>
                        ‚úÖ Forces description click
                    </div>
                </div>
            </div>

            <div class="content-panel">
                <div class="section">
                    <h3>‚úçÔ∏è Generate Your Trading Script</h3>
                    
                    <div class="input-group">
                        <label>Video Title / Main Topic</label>
                        <input type="text" id="videoTitle" placeholder="e.g., Why Trading Multiple Setups Keeps You Broke" />
                    </div>

                    <div class="input-group">
                        <label>Core Insight (Optional)</label>
                        <textarea id="coreInsight" placeholder="What counterintuitive truth will you reveal? (AI creates if blank)"></textarea>
                    </div>

                    <div class="input-group">
                        <label>Key Points (Optional)</label>
                        <textarea id="keyPoints" placeholder="‚Ä¢ Main psychological trap&#10;‚Ä¢ Why it happens&#10;‚Ä¢ Real examples&#10;‚Ä¢ Actionable solution"></textarea>
                    </div>

                    <div class="info-box">
                        <strong>ü§ñ AI Will Create (MAXIMUM QUALITY MODE):</strong><br>
                        ‚úÖ Intelligent narrative approach selection<br>
                        ‚úÖ Deep psychological frameworks<br>
                        ‚úÖ Real trader examples (Seykota, Livermore, Tudor Jones)<br>
                        ‚úÖ Specific implementation steps with numbers<br>
                        ‚úÖ Product CTA with MASSIVE desire (NO PRICE)<br>
                        ‚úÖ Educational-first approach (reference quality)<br>
                        ‚úÖ Auto-cleaning of artifacts & price mentions<br>
                        ‚úÖ Quality validation & scoring<br>
                        üé® <strong>BONUS:</strong> 6 AI image prompts (thumbnail + 5 scenes)
                    </div>

                    <button class="btn" id="generateBtn" onclick="generateScript()">üöÄ GENERATE HIGH-QUALITY SCRIPT</button>
                    
                    <div class="error-box" id="errorBox"></div>
                </div>

                <div class="progress-section" id="progressSection">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill">0%</div>
                    </div>
                    <div class="status" id="status">Ready to generate...</div>
                </div>

                <div class="result-card" id="resultCard">
                    <h3 style="color: #10b981; text-align: center; margin-bottom: 20px;">üéâ Script Complete!</h3>
                    
                    <div class="stats">
                        <div class="stat-box">
                            <span class="stat-number" id="charCount">0</span>
                            <span class="stat-label">Characters</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-number" id="wordCount">0</span>
                            <span class="stat-label">Words</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-number" id="chunkCount">1</span>
                            <span class="stat-label">ONE Block</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-number" id="timeCount">0s</span>
                            <span class="stat-label">Time</span>
                        </div>
                    </div>

                    <button class="btn download-btn" onclick="downloadScript()" style="margin-bottom: 15px;">
                        üì• DOWNLOAD VOICE-READY SCRIPT
                    </button>

                    <button class="btn download-btn" onclick="downloadImagePrompts()" id="downloadImageBtn" style="display: none; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                        üé® DOWNLOAD AI IMAGE PROMPTS (6 Prompts)
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedLength = 60000;
        let finalScript = '';
        let finalImagePrompts = '';
        let startTime = 0;

        const PRODUCT = {
            name: "THE 7-FIGURE TRADER'S MIND VAULT",
            tagline: "The Complete Psychology System That Separates The Top 5% From Everyone Else",
            value: "Everything the elite traders studied to master their psychology - the frameworks, the audiobooks, the mental systems that turned struggling traders into consistent winners."
        };

        function selectLength(length, element) {
            selectedLength = length;
            document.querySelectorAll('.length-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            
            document.getElementById('lengthInfo').innerHTML = `
                Selected: <strong>${(length/1000)}K minimum</strong><br>
                ONE seamless block<br>
                Maximum quality mode
            `;
        }

        function updateStatus(msg) {
            const statusDiv = document.getElementById('status');
            const timestamp = new Date().toLocaleTimeString();
            statusDiv.innerHTML += `<div>[${timestamp}] ${msg}</div>`;
            statusDiv.scrollTop = statusDiv.scrollHeight;
        }

        function updateProgress(percent) {
            const fill = document.getElementById('progressFill');
            fill.style.width = percent + '%';
            fill.textContent = Math.round(percent) + '%';
        }

        function showError(msg) {
            const errorBox = document.getElementById('errorBox');
            errorBox.textContent = '‚ö†Ô∏è ' + msg;
            errorBox.classList.add('show');
            setTimeout(() => errorBox.classList.remove('show'), 8000);
        }

        async function callGemini(prompt, temperature = 0.85, retryCount = 0) {
            const apiKey = document.getElementById('apiKey').value;
            const maxRetries = 3;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: {
                            temperature: temperature,
                            maxOutputTokens: 65536,
                            topP: 0.92,
                            topK: 35
                        }
                    })
                });

                if (response.status === 429) {
                    if (retryCount < maxRetries) {
                        const waitTime = Math.pow(2, retryCount) * 5;
                        updateStatus(`‚è≥ Rate limit, waiting ${waitTime}s (retry ${retryCount + 1}/${maxRetries})...`);
                        await new Promise(r => setTimeout(r, waitTime * 1000));
                        return callGemini(prompt, temperature, retryCount + 1);
                    }
                    throw new Error('Rate limit exceeded. Wait 60 seconds and try again.');
                }

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`API Error: ${errorData.error?.message || response.statusText}`);
                }

                const data = await response.json();
                if (!data.candidates?.[0]?.content?.parts?.[0]?.text) {
                    throw new Error('Invalid API response');
                }

                return data.candidates[0].content.parts[0].text.trim();
            } catch (error) {
                if (retryCount < maxRetries && error.message.includes('fetch')) {
                    updateStatus(`‚ö†Ô∏è Network error, retrying (${retryCount + 1}/${maxRetries})...`);
                    await new Promise(r => setTimeout(r, 2000));
                    return callGemini(prompt, temperature, retryCount + 1);
                }
                throw error;
            }
        }

        function cleanChunkArtifacts(text) {
            text = text.replace(/üìù CONTINUE FROM:.*?\n/g, '');
            text = text.replace(/\*\*CONTINUE.*?\*\*/gi, '');
            text = text.replace(/\*\*BEGIN.*?\*\*/gi, '');
            text = text.replace(/\*\*COMPLETE.*?\*\*/gi, '');
            text = text.replace(/Chunk \d+\/\d+/gi, '');
            text = text.replace(/Continue seamlessly.*/gi, '');
            text = text.replace(/Let me continue.*/gi, '');
            text = text.replace(/Continuing from.*/gi, '');
            text = text.replace(/\n{4,}/g, '\n\n\n');

            return text.trim();
        }

        function cleanScript(text) {
            // Remove chunk artifacts
            text = text.replace(/üìù.*?CONTINUE.*?\n/gi, '');
            text = text.replace(/\*\*CHUNK.*?\*\*/gi, '');
            text = text.replace(/Continue seamlessly.*?\n/gi, '');
            text = text.replace(/Continuing from.*?\n/gi, '');
            text = text.replace(/In the previous section.*?\./gi, '');
            text = text.replace(/As we discussed.*?\./gi, '');
            text = text.replace(/As mentioned.*?\./gi, '');

            // Remove any price mentions that slipped through (CRITICAL)
            text = text.replace(/\$\d+/g, '');
            text = text.replace(/\d+\s*dollars?/gi, '');
            text = text.replace(/\b(price|cost|afford|cheap|expensive|discount|sale)\b/gi, '');

            // Remove ALL markdown formatting for CLEAN VOICE-READY output (CRITICAL)
            text = text.replace(/\*\*\*(.+?)\*\*\*/g, '$1');  // Bold+Italic
            text = text.replace(/\*\*(.+?)\*\*/g, '$1');      // Bold
            text = text.replace(/\*(.+?)\*/g, '$1');          // Italic
            text = text.replace(/__(.+?)__/g, '$1');          // Bold underscore
            text = text.replace(/_(.+?)_/g, '$1');            // Italic underscore
            text = text.replace(/~~(.+?)~~/g, '$1');          // Strikethrough
            text = text.replace(/`(.+?)`/g, '$1');            // Inline code
            text = text.replace(/#{1,6}\s+/g, '');            // Headers
            text = text.replace(/\[(.+?)\]\(.+?\)/g, '$1');   // Links
            text = text.replace(/^[\s]*[-*+]\s+/gm, '');      // List bullets
            text = text.replace(/^\d+\.\s+/gm, '');           // Numbered lists
            text = text.replace(/^>\s+/gm, '');               // Blockquotes

            // Remove any remaining asterisks and formatting
            text = text.replace(/\*asterisk\*/gi, '');
            text = text.replace(/\*/g, '');  // Remove any remaining asterisks

            // Fix spacing issues
            text = text.replace(/\n{4,}/g, '\n\n\n');
            text = text.replace(/  +/g, ' ');

            // Fix common errors
            text = text.replace(/sevenf figureure/g, 'seven-figure');
            text = text.replace(/rugible/g, 'regrettable');
            text = text.replace(/sestyme/g, 'system');

            return text.trim();
        }

        function selectNarrativeApproach(title) {
            const lowerTitle = title.toLowerCase();

            // Journey/Transformation topics
            if (lowerTitle.includes('quit') || lowerTitle.includes('fail') ||
                lowerTitle.includes('journey') || lowerTitle.includes('transformation') ||
                lowerTitle.includes('moment') || lowerTitle.includes('suffer')) {
                return 'JOURNEY';
            }

            // Counterintuitive/Paradox topics
            if ((lowerTitle.includes('why') || lowerTitle.includes('celebrating')) &&
                (lowerTitle.includes('but') || lowerTitle.includes('actually') ||
                 lowerTitle.includes('lose') || lowerTitle.includes('sounds insane'))) {
                return 'PARADOX';
            }

            // Problem/Solution topics
            if (lowerTitle.includes('stop') || lowerTitle.includes('avoid') ||
                lowerTitle.includes('mistake') || lowerTitle.includes('95%') ||
                (lowerTitle.includes('why') && lowerTitle.includes('traders'))) {
                return 'PROBLEM_SOLUTION';
            }

            // Default to educational framework
            return 'FRAMEWORK';
        }

        function validateQuality(script) {
            const issues = [];

            // Check for asterisks
            if (script.includes('asterisk') || /\*\*|\*|__/.test(script)) {
                issues.push('‚ö†Ô∏è Contains markdown/asterisks - auto-cleaning...');
                // Auto-clean markdown
                script = script.replace(/\*\*\*(.+?)\*\*\*/g, '$1');
                script = script.replace(/\*\*(.+?)\*\*/g, '$1');
                script = script.replace(/\*(.+?)\*/g, '$1');
                script = script.replace(/__(.+?)__/g, '$1');
                script = script.replace(/_(.+?)_/g, '$1');
                script = script.replace(/\*/g, '');
            }

            // Check for price mentions (CRITICAL)
            if (/\$\d+|\d+\s*dollars?|price|cost/i.test(script)) {
                issues.push('‚ö†Ô∏è CRITICAL: Contains price mention - auto-cleaning...');
                // Auto-clean
                script = script.replace(/\$\d+/g, '');
                script = script.replace(/\d+\s*dollars?/gi, '');
                script = script.replace(/\b(price|cost)\b/gi, '');
            }

            // Check for "link in description" mentions
            const linkMentions = (script.toLowerCase().match(/link in (the )?description/g) || []).length;
            if (linkMentions < 2) {
                issues.push(`Only ${linkMentions} "link in description" mentions (need 2-3)`);
            } else if (linkMentions > 3) {
                issues.push(`Too many "link in description" mentions: ${linkMentions} (need 2-3)`);
            }

            // Check for repetitive transitions
            const transitions = ['let me tell you', 'here\'s the thing', 'the truth is'];
            transitions.forEach(phrase => {
                const count = (script.toLowerCase().match(new RegExp(phrase, 'g')) || []).length;
                if (count > 2) {
                    issues.push(`Repetitive phrase: "${phrase}" appears ${count} times`);
                }
            });

            // Check for meta-commentary
            if (script.includes('continue') && script.includes('previous')) {
                issues.push('Contains chunk artifacts');
            }

            // Check for sales language
            const salesTerms = ['buy now', 'limited time', 'discount', 'special offer', 'act now'];
            salesTerms.forEach(term => {
                if (script.toLowerCase().includes(term)) {
                    issues.push(`Sales language detected: "${term}"`);
                }
            });

            // Check for quality markers
            const hasNumbers = /\$[\d,]+/.test(script) || /\d+%/.test(script);
            const hasRealTraders = /(Livermore|Seykota|Tudor Jones|Minervini|O'Neil)/i.test(script);

            if (!hasNumbers) issues.push('Consider adding specific dollar amounts or percentages');
            if (!hasRealTraders) issues.push('Consider adding real trader examples');

            return {
                clean: issues.length === 0,
                issues: issues,
                quality: issues.length === 0 ? 'HIGH' : issues.length < 3 ? 'MEDIUM' : 'LOW',
                script: script
            };
        }

        async function generateScript() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const title = document.getElementById('videoTitle').value.trim();
            const coreInsight = document.getElementById('coreInsight').value.trim();
            const keyPoints = document.getElementById('keyPoints').value.trim();

            if (!apiKey) {
                showError('Please enter your Gemini API key');
                return;
            }
            
            if (!title) {
                showError('Please enter a video title');
                return;
            }

            startTime = Date.now();
            const btn = document.getElementById('generateBtn');
            btn.disabled = true;
            btn.textContent = '‚è≥ GENERATING...';

            document.getElementById('progressSection').style.display = 'block';
            document.getElementById('resultCard').classList.remove('show');
            document.getElementById('status').innerHTML = '<div>üöÄ Starting high-quality generation...</div>';
            finalScript = '';
            finalImagePrompts = '';
            document.getElementById('downloadImageBtn').style.display = 'none';

            const chunks = [];

            try {
                // Detect narrative approach
                const approach = selectNarrativeApproach(title);
                updateStatus(`üß† Narrative approach: ${approach}`);

                updateStatus(`üé® Part 1: Hook & Core Framework...`);
                updateProgress(25);

                const prompt1 = buildPrompt1(title, coreInsight, keyPoints, approach);
                const chunk1 = await callGemini(prompt1, 0.90);  // Higher creativity for hook
                chunks.push(chunk1);
                updateStatus(`‚úÖ Part 1 complete: ${chunk1.length.toLocaleString()} chars`);
                await new Promise(r => setTimeout(r, 1500));

                updateStatus(`üé® Part 2: Deep Insights & Examples...`);
                updateProgress(50);

                const lastSentences = chunk1.split(/[.!?]/).filter(s => s.trim().length > 20).slice(-4).join('. ') + '.';
                const prompt2 = buildPrompt2(title, lastSentences, approach);
                const chunk2 = await callGemini(prompt2, 0.85);  // Balanced
                chunks.push(chunk2);
                updateStatus(`‚úÖ Part 2 complete: ${chunk2.length.toLocaleString()} chars`);
                await new Promise(r => setTimeout(r, 1500));

                updateStatus(`üé® Part 3: Implementation & Close...`);
                updateProgress(75);

                const lastSentences2 = chunk2.split(/[.!?]/).filter(s => s.trim().length > 20).slice(-4).join('. ') + '.';
                const prompt3 = buildPrompt3(title, lastSentences2, approach);
                const chunk3 = await callGemini(prompt3, 0.80);  // Lower for focused close
                chunks.push(chunk3);
                updateStatus(`‚úÖ Part 3 complete: ${chunk3.length.toLocaleString()} chars`);

                updateStatus(`üßπ Creating ONE seamless block...`);
                updateProgress(85);

                finalScript = chunks.join('\n\n');
                finalScript = cleanScript(finalScript);

                updateStatus(`üîç Validating quality & removing price mentions...`);
                updateProgress(92);

                const validation = validateQuality(finalScript);
                finalScript = validation.script;

                if (validation.issues.length > 0) {
                    updateStatus(`‚ö†Ô∏è Quality Check: ${validation.quality}`);
                    validation.issues.forEach(issue => updateStatus(`  - ${issue}`));
                } else {
                    updateStatus(`‚úÖ Quality Check: ${validation.quality} - Perfect!`);
                }

                const totalTime = Math.round((Date.now() - startTime) / 1000);
                const totalWords = Math.round(finalScript.length / 4.6);

                document.getElementById('charCount').textContent = finalScript.length.toLocaleString();
                document.getElementById('wordCount').textContent = totalWords.toLocaleString();
                document.getElementById('timeCount').textContent = totalTime + 's';

                // Generate AI Image Prompts (4th API call)
                updateStatus(`üé® Generating 6 AI image prompts...`);
                updateProgress(95);

                try {
                    const imagePromptRequest = buildImagePromptRequest(title, finalScript);
                    console.log('üé® Starting image prompt generation...');
                    await new Promise(r => setTimeout(r, 1500)); // Rate limit pause
                    finalImagePrompts = await callGemini(imagePromptRequest, 0.75);
                    console.log('‚úÖ Image prompts received, length:', finalImagePrompts.length);

                    updateStatus(`‚úÖ Image prompts generated successfully!`);
                    updateStatus(`üé® 6 prompts ready: 1 Thumbnail + 5 Scene Illustrations`);

                    // Show the image prompts download button
                    const downloadBtn = document.getElementById('downloadImageBtn');
                    downloadBtn.style.display = 'block';
                    downloadBtn.textContent = 'üé® DOWNLOAD AI IMAGE PROMPTS (6 Prompts)';
                    downloadBtn.disabled = false;
                } catch (imageError) {
                    console.error('‚ùå Image generation error:', imageError);
                    updateStatus(`‚ö†Ô∏è Image prompt generation failed: ${imageError.message}`);
                    updateStatus(`üí° Tip: Check API key rate limits (15 RPM free tier)`);
                    updateStatus(`‚úÖ Script generation successful - you can retry for images`);

                    // Show button but disabled with error message
                    const downloadBtn = document.getElementById('downloadImageBtn');
                    downloadBtn.style.display = 'block';
                    downloadBtn.textContent = '‚ö†Ô∏è Image Generation Failed - Retry Script Generation';
                    downloadBtn.disabled = true;
                    downloadBtn.style.opacity = '0.6';
                    // Don't fail the whole process if image generation fails
                }

                updateProgress(100);
                updateStatus(`üéâ Complete! ${finalScript.length.toLocaleString()} characters in ${totalTime}s`);
                updateStatus(`‚úÖ High-quality, educational, voice-ready, NO PRICE MENTIONS!`);

                document.getElementById('resultCard').classList.add('show');

            } catch (error) {
                updateStatus(`‚ùå ERROR: ${error.message}`);
                showError(error.message);
                console.error(error);
            } finally {
                btn.disabled = false;
                btn.textContent = 'üöÄ GENERATE HIGH-QUALITY SCRIPT';
            }
        }

        function buildPrompt1(title, coreInsight, keyPoints, approach) {
            const targetChars = Math.floor(selectedLength / 3);

            return `You are an elite trading education scriptwriter. Study these reference examples:

REFERENCE STYLE - Notice the professional, educational quality:

"95% of traders lose money. But the reason isn't what most people think.

It's not because they lack intelligence. It's not because they don't have access to information. Every struggling trader I've worked with has had access to the same charts, the same indicators, the same patterns as successful traders.

The difference comes down to something most traders never address. A psychological pattern so fundamental that until you recognize it, consistent profitability remains out of reach.

Smart money trades liquidity. They understand that every major move requires fuel - retail traders positioned on the wrong side. This isn't theory. This is how markets actually work. Professional traders identify where retail stops cluster, where breakout buyers will enter, where weak hands will panic exit. Then they trade the opposite side.

Retail traders do the exact opposite. They chase breakouts after the move is exhausted. They place stops exactly where everyone else does. They enter when the setup looks 'obvious' - which means smart money has already positioned and is now looking to exit into their orders."

Notice: Clean language, specific insights, educational focus, no manipulation.

TITLE: "${title}"
${coreInsight ? `CORE INSIGHT: ${coreInsight}` : ''}
${keyPoints ? `KEY POINTS:\n${keyPoints}` : ''}

NARRATIVE APPROACH: ${approach}
${approach === 'PARADOX' ? '(Use counterintuitive hook like "Celebrating when you lose money...")' : ''}
${approach === 'JOURNEY' ? '(Use personal transformation narrative like "Most traders like to talk about their wins...")' : ''}
${approach === 'PROBLEM_SOLUTION' ? '(Use direct problem analysis like "95% of traders lose money...")' : ''}

TARGET: ${targetChars.toLocaleString()} characters MINIMUM

PRODUCT (integrate ONLY if natural - build MASSIVE desire, ZERO price mention):
${PRODUCT.name}
${PRODUCT.tagline}
${PRODUCT.value}

PRODUCT INTEGRATION MASTERY (when you mention it):
‚úÖ Frame as WHAT THE ELITE ACTUALLY STUDY
‚úÖ Contrast with what amateurs chase (indicators, signals)
‚úÖ Create curiosity: "This is what you'll discover inside..."
‚úÖ Positioning: "The frameworks that turned struggling traders into consistent winners"
‚úÖ Authority: "What every 7-figure trader has studied and mastered"
‚úÖ Exclusivity: "The mental systems most traders never even know exist"
‚úÖ End with: "Link in the description" (NO price, NO urgency, just access)

FORBIDDEN PRODUCT LANGUAGE:
‚ùå NO price mention (no $67, no "affordable", no cost talk)
‚ùå NO "buy now", "limited time", "discount", "special offer"
‚ùå NO desperate sales language
‚ùå NO breaking educational tone

OPENING THIRD STRUCTURE:
1. Hook immediately with counterintuitive truth or relatable problem
2. Establish credibility through insight, not claims
3. Present the core framework or psychological pattern
4. Use specific examples (real traders or realistic scenarios with exact numbers)
5. Build toward deeper exploration
6. [OPTIONAL] Drop ONE product mention that creates massive curiosity

QUALITY RULES (DOCUMENT 8 STANDARD):
‚úÖ Vary every paragraph opening (never repeat transitions)
‚úÖ MAXIMUM 20 WORDS PER SENTENCE (strict limit for voice-ready flow)
‚úÖ Mix sentence lengths: short punches (6-10 words) + explanations (12-18 words MAX)
‚úÖ Use specific numbers ($8,432 not "$8,000", "6 weeks" not "a while")
‚úÖ Educational tone - teaching not selling
‚úÖ Professional confidence without hype
‚úÖ Natural language - conversational but intelligent
‚úÖ Real trader examples when appropriate (Seykota, Livermore, Tudor Jones, Minervini, O'Neil)
‚úÖ Clean psychological frameworks explained clearly
‚úÖ CLEAN VOICE-READY TEXT - absolutely NO markdown, asterisks, or formatting
‚úÖ Include "Link in description" at LEAST once in this section

‚ùå FORBIDDEN:
‚ùå Asterisks, markdown formatting (**bold**, *italic*, etc.)
‚ùå Any formatting symbols or special characters
‚ùå Sentences over 20 words
‚ùå Repetitive phrases ("Let me tell you", "Here's the thing", etc.)
‚ùå Fake urgency or scarcity tactics
‚ùå Melodramatic language
‚ùå Template-feel or robotic structure
‚ùå Price mentions anywhere
‚ùå Desperate sales language
‚ùå Meta-commentary about the script itself

EXAMPLE PRODUCT MENTION (if natural and helpful):
"This understanding - the psychological frameworks that separate the top 5% from the 95% who never make it - is exactly what you'll find inside ${PRODUCT.name}. The complete mental systems that elite traders actually study. Trading in the Zone, The Disciplined Trader, every framework that rewires how you think about risk, losses, and discipline. Link in the description. But first, let me show you exactly why this changes everything..."

Notice: NO price, creates curiosity, feels valuable not salesy.

Write ${targetChars.toLocaleString()} characters of pure educational value. Match the reference quality.`;
        }

        function buildPrompt2(title, previousEnding, approach) {
            const targetChars = Math.floor(selectedLength / 3);

            return `Continue this trading education script SEAMLESSLY.

REFERENCE QUALITY - Educational, insightful, professional.

PREVIOUS SECTION ENDED:
${previousEnding}

Continue naturally - NO meta-commentary, NO "continuing from", just flow.

TARGET: ${targetChars.toLocaleString()} characters MINIMUM

NARRATIVE APPROACH: ${approach}

MIDDLE SECTION SHOULD:
1. Deepen the core insight with concrete examples
2. Show contrast (what works vs what doesn't)
3. Explain mechanisms and psychology clearly
4. Use real trader stories or realistic comparisons with specific numbers
5. Build toward practical implementation
6. [OPTIONAL] Brief product callback IF fits naturally (NO PRICE)

PRODUCT CALLBACK (if natural, OPTIONAL):
‚úÖ Reference what elite traders studied vs what amateurs chase
‚úÖ Frame as "the systems that actually work"
‚úÖ Create desire through demonstration of value
‚úÖ NO price mention ever
‚úÖ Example: "This exact framework - the one consistently profitable traders use - is covered in ${PRODUCT.name}. The complete psychology system. Link in the description."

CONTENT GUIDELINES:
- Deep dive into the psychological/cognitive mechanism
- Comparison framework: Trader A (wrong) vs Trader B (right) with specific outcomes
- Real trader examples: Seykota, Livermore, Tudor Jones, Minervini, O'Neil
- Explain edge conditions: market regimes, volatility, optimal conditions
- Show progression and compounding effects with numbers
- Make it about METHOD not luck

QUALITY STANDARDS (DOCUMENT 8 STANDARD):
‚úÖ Educational and valuable every paragraph
‚úÖ MAXIMUM 20 WORDS PER SENTENCE (strict limit)
‚úÖ Specific, actionable insights with real numbers
‚úÖ Professional tone without hype
‚úÖ Varied language and structure
‚úÖ Real examples and frameworks
‚úÖ No manipulation
‚úÖ NO price mention anywhere
‚úÖ CLEAN VOICE-READY TEXT - NO markdown or formatting
‚úÖ Include "Link in description" if you mention product (optional in this section)

‚ùå FORBIDDEN:
‚ùå Markdown formatting (**bold**, *italic*, etc.)
‚ùå Asterisks or special characters
‚ùå Sentences over 20 words
‚ùå Meta-commentary about script structure
‚ùå "As I mentioned" or "continuing from"
‚ùå Repetitive transitions
‚ùå Fake urgency
‚ùå Price mentions
‚ùå Sales language

Write ${targetChars.toLocaleString()} characters continuing seamlessly with high educational value.`;
        }

        function buildPrompt3(title, previousEnding, approach) {
            const targetChars = Math.floor(selectedLength / 3);

            return `Complete this trading education script professionally.

REFERENCE QUALITY - Educational, professional, powerful close.

PREVIOUS SECTION ENDED:
${previousEnding}

Continue and COMPLETE naturally.

TARGET: ${targetChars.toLocaleString()} characters MINIMUM

NARRATIVE APPROACH: ${approach}

PRODUCT FOR FINAL CTA:
${PRODUCT.name}
${PRODUCT.tagline}
${PRODUCT.value}

FINAL SECTION SHOULD:
1. Provide specific implementation steps (actionable framework)
2. Set realistic expectations and timeframes
3. Contrast the two paths clearly
4. Strong product CTA that creates DESIRE and CURIOSITY (NO PRICE)
5. Value-focused close with subscribe CTA

IMPLEMENTATION FRAMEWORK (give specific steps):
- Step 1: Specific action, why it works, how to do it, timeframe
- Step 2: Specific action, why it works, how to do it, timeframe
- Step 3: Specific action, why it works, how to do it, timeframe
- Include realistic expectations (100+ trades, 90+ days, patience required)

PRODUCT FINAL CTA (MAXIMUM DESIRE, ZERO PRICE):

Build massive value, create FOMO of missing out on knowledge, make description link irresistible.

APPROACH: List what's inside, contrast elite vs amateur, position as essential, create curiosity.

EXAMPLE STRUCTURE:
"Look, you can keep doing what you've been doing and hope something changes. Keep chasing indicators while your account bleeds. Keep making the same psychological mistakes that destroy 95% of traders.

Or you can equip yourself with the same mental frameworks that 7-figure traders use every single day.

Inside ${PRODUCT.name}, you get the complete psychology transformation system. Every framework that separates the top 5% from everyone else. Trading in the Zone. The Disciplined Trader. Market Wizards. Every mental system that elite traders studied to rewire their brains for consistency.

The frameworks that turn emotional gamblers into disciplined professionals. The exact mental tools that make the difference between blowing up and compounding wealth.

This is what the top 5% actually study while everyone else chases the next hot indicator.

Link in the description. This is the difference between staying stuck and finally breaking through.

If you got value from this, hit subscribe. Let me know in the comments what clicked for you. I'll see you in the next one."

CRITICAL CTA RULES (DOCUMENT 8 STANDARD):
‚úÖ Build MASSIVE value (list what's inside: books, frameworks, systems)
‚úÖ Create FOMO (what top 5% study vs what amateurs chase)
‚úÖ Position as ESSENTIAL (difference between success and failure)
‚úÖ Authority (mention specific books/systems: Trading in the Zone, Disciplined Trader, Market Wizards)
‚úÖ Contrast (this vs staying stuck)
‚úÖ STRATEGIC "Link in description" placement: 2-3 times total in script (ensure at least 1-2 in this section)
‚ùå NEVER mention price (creates mystery, forces click)
‚ùå NO "buy now", "limited time", sales language
‚ùå NO desperation or begging

ALTERNATIVE: If topic doesn't fit product well, do pure value close with just subscribe CTA.

QUALITY STANDARDS (DOCUMENT 8 STANDARD):
‚úÖ Educational and valuable throughout
‚úÖ MAXIMUM 20 WORDS PER SENTENCE (strict limit for voice-ready flow)
‚úÖ Specific implementation steps with numbers
‚úÖ Professional tone maintained
‚úÖ Natural product integration that feels helpful
‚úÖ Strong close that ties everything together
‚úÖ NO price mention anywhere
‚úÖ CLEAN VOICE-READY TEXT - absolutely NO markdown, asterisks, or formatting

‚ùå FORBIDDEN:
‚ùå Markdown formatting (**bold**, *italic*, etc.)
‚ùå Asterisks or special characters
‚ùå Sentences over 20 words
‚ùå Price mentions
‚ùå "Buy now" or sales pressure
‚ùå Fake urgency
‚ùå Breaking educational tone
‚ùå Overpromising results
‚ùå Desperate language

Write ${targetChars.toLocaleString()} characters completing the script powerfully with NO PRICE MENTION.`;
        }

        function buildImagePromptRequest(title, script) {
            return `You are an expert AI image prompt writer for trading psychology YouTube content.

GENERATED SCRIPT:
${script.substring(0, 8000)}... [Script continues - analyze full narrative arc]

VIDEO TITLE: ${title}

YOUR TASK:
Create 6 detailed AI image generation prompts for this trading psychology video script. Follow this EXACT structure:

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
IMAGE 1 - THUMBNAIL (YouTube Thumbnail Style)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Title Text for Red Box: [EXTRACT 2-4 KEY WORDS FROM: "${title}"]

AI Image Generation Prompt:
"YouTube thumbnail design, professional trading content, RED rectangular banner at top of image (#E74C3C), white bold sans-serif text inside red banner reading '[EXTRACTED KEY WORDS]', below banner: minimalist stick figure illustration in navy blue (#2C3E50), stick figure sitting at modern trading desk, computer monitor showing candlestick chart with [RELEVANT PATTERN FROM SCRIPT], [EMOTIONAL STATE FROM SCRIPT] body language, clean white background (#FFFFFF), simple clean lines, limited color palette (red banner, navy blue figure, orange/yellow accents #F39C12, green for profits #27AE60, red for losses #E74C3C), professional digital art style, ultra-clean composition, YouTube thumbnail optimized, 16:9 aspect ratio, no additional text overlays, no speech bubbles, high contrast for mobile viewing."

Visual Elements:
‚úì RED rectangular box at top (spanning width)
‚úì White bold text: "[EXTRACTED KEY WORDS]"
‚úì Stick figure at trading desk
‚úì Monitor with [specific chart pattern from script]
‚úì [Emotional state from script] body language
‚úì Clean professional background

Color Palette:
Banner: RED (#E74C3C)
Text in Banner: WHITE (#FFFFFF)
Stick Figure: Navy Blue (#2C3E50)
Background: White/Light Gray (#FFFFFF, #ECF0F1)
Accents: Orange (#F39C12), Green (#27AE60) for wins, Red for losses

Emotional Tone: [Based on script narrative]
Chart Pattern: [Based on script topic]
Composition: Red banner top 20%, stick figure scene bottom 80%

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
IMAGE 2 - PROBLEM SCENE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Scene Context: [Extract problem description from script - what struggle does the amateur trader face?]

AI Image Generation Prompt:
"Minimalist stick figure illustration, stressed trader with hunched forward posture, navy blue stick figure (#2C3E50), gripping head with hands showing frustration, sitting at trading desk, computer monitor showing RED declining candlestick chart, stress lines radiating from figure, thought bubble with '[EXTRACT WORRIED THOUGHT FROM SCRIPT]', scattered papers on desk, coffee cup, tense body language, clean light background, professional digital art, simple clean lines, limited color palette (navy blue figure, red losing chart #E74C3C, dark gray accents #34495E), sense of chaos and stress, no text overlays except thought bubble, suitable for educational video content."

Visual Elements:
‚úì Stressed stick figure (hunched, frustrated)
‚úì Red declining chart on monitor
‚úì Thought bubble: "[Worried thought from script]"
‚úì Chaotic desk environment
‚úì Tense body language

Emotional Tone: Stressed, frustrated, overwhelmed
Chart Pattern: Declining red candles, losses
Purpose: Show the problem/struggle traders face

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
IMAGE 3 - EMOTIONAL STRUGGLE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Scene Context: [Extract struggle moment from script - what internal conflict does the trader face?]

AI Image Generation Prompt:
"Minimalist stick figure illustration, conflicted trader showing indecision, navy blue stick figure (#2C3E50), sitting at trading desk with hand on chin in contemplative pose, computer monitor showing [EXTRACT CHART PATTERN FROM SCRIPT], two thought bubbles showing internal conflict - left bubble: '[EXTRACT FEAR THOUGHT FROM SCRIPT]', right bubble: '[EXTRACT GREED/HOPE THOUGHT FROM SCRIPT]', clean background, professional digital art, simple clean lines, limited color palette (navy blue, orange accents #F39C12, gray #95A5A6), sense of internal battle, no additional text, educational video style."

Visual Elements:
‚úì Contemplative stick figure
‚úì Chart showing key decision point
‚úì Two thought bubbles (internal conflict)
‚úì Clean, focused composition

Emotional Tone: Conflicted, indecisive, internal struggle
Chart Pattern: [Based on script - breakout, consolidation, etc.]
Purpose: Show the psychological battle

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
IMAGE 4 - CONCEPT/FRAMEWORK EXPLANATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Scene Context: [Extract core concept/framework from script - what is the key insight or system being taught?]

AI Image Generation Prompt:
"Minimalist stick figure illustration, confident trader in teaching pose, navy blue stick figure (#2C3E50), sitting at organized trading desk, single clean monitor showing [EXTRACT FRAMEWORK VISUALIZATION FROM SCRIPT - could be support/resistance, risk zones, etc.], thought bubble: '[EXTRACT KEY CONCEPT INSIGHT FROM SCRIPT]', calm focused body language, clean minimalist background, professional digital art, simple clean lines, limited color palette (navy blue, green success indicators #27AE60, orange framework highlights #F39C12), sense of clarity and understanding, educational diagram style on screen, no text overlays except thought bubble."

Visual Elements:
‚úì Confident, teaching posture
‚úì Clear framework visualization on screen
‚úì Thought bubble: "[Core concept insight from script]"
‚úì Organized, professional setup

Emotional Tone: Confident, clear, educational
Visual Style: Framework/system visualization
Purpose: Explain the solution/concept

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
IMAGE 5 - PROFESSIONAL EXECUTION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Scene Context: [Extract solution from script - how does the professional trader execute correctly?]

AI Image Generation Prompt:
"Minimalist stick figure illustration, calm professional trader in zen-like posture, navy blue stick figure (#2C3E50), sitting relaxed at trading desk, single monitor showing GREEN ascending candlestick chart, small risk label visible '0.10' on desk, thought bubble: '[EXTRACT DISCIPLINED THOUGHT FROM SCRIPT]', peaceful body language, clean organized environment, professional digital art, simple clean lines, limited color palette (navy blue, green winning chart #27AE60, white background #FFFFFF), sense of control and peace, no additional text except labels and thought bubble."

Visual Elements:
‚úì Calm, zen-like posture
‚úì Green winning chart
‚úì Small risk indicator "0.10"
‚úì Peaceful organized environment
‚úì Thought bubble: "[Disciplined mindset from script]"

Emotional Tone: Calm, controlled, professional
Chart Pattern: Winning trade, upward trend
Purpose: Show the correct professional approach

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
IMAGE 6 - BEFORE/AFTER TRANSFORMATION (Split Screen)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Scene Context: [Extract transformation arc from script - what is the contrast between amateur and professional?]

AI Image Generation Prompt:
"Minimalist stick figure split-screen comparison, LEFT SIDE: stressed amateur trader hunched over desk, RED declining chart on monitor, label '10.00' high risk visible, thought bubble showing worry '[EXTRACT AMATEUR MINDSET FROM SCRIPT]', chaotic environment | VERTICAL DIVIDING LINE in center | RIGHT SIDE: calm professional trader in zen posture, GREEN ascending chart on monitor, label '0.10' small risk visible, thought bubble showing discipline '[EXTRACT PROFESSIONAL MINDSET FROM SCRIPT]', organized environment | both traders navy blue (#2C3E50), professional digital art, simple clean lines, clear before/after contrast, limited color palette (navy blue figures, red for losses #E74C3C, green for wins #27AE60, white background #FFFFFF), powerful transformation visual, no additional text except risk labels and thought bubbles, YouTube video thumbnail style."

Visual Elements:
‚úì LEFT: Amateur (stressed, red chart, "10.00" risk)
‚úì CENTER: Vertical dividing line
‚úì RIGHT: Professional (calm, green chart, "0.10" risk)
‚úì Clear visual contrast and transformation

Emotional Tone: Contrasting - struggle to success
Purpose: Show complete transformation journey
Composition: 50/50 split, clear "before and after"

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

CRITICAL REQUIREMENTS:
‚úì Thumbnail (Image 1) MUST have RED box (#E74C3C) with WHITE text
‚úì All stick figures navy blue (#2C3E50)
‚úì Trading desks and monitors in every scene
‚úì Specific chart patterns based on script content
‚úì Emotional states match script narrative
‚úì Extract actual thoughts/quotes from the script for thought bubbles
‚úì Clean, professional, YouTube-optimized
‚úì Each prompt 150-200 words, highly detailed
‚úì Include color codes, composition details, emotional tone
‚úì NO RED BOX in images 2-6 (only thumbnail has red box)

ANALYZE THE SCRIPT CAREFULLY:
- Identify the main problem/struggle
- Extract the core psychological insight
- Find the solution/framework presented
- Capture the transformation arc
- Use actual language from the script for thought bubbles

Generate all 6 prompts now in the structured format above. Make each prompt detailed and specific to THIS script's narrative.`;
        }

        function downloadScript() {
            if (!finalScript) {
                alert('No script to download!');
                return;
            }

            const title = document.getElementById('videoTitle').value.trim() || 'trading_script';
            const safeTitle = title.replace(/[^a-z0-9]/gi, '_').toLowerCase().substring(0, 50);
            const filename = `${safeTitle}_high_quality_${Date.now()}.txt`;
            
            const statsHeader = `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ELITE TRADING SCRIPT - HIGH QUALITY MODE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Title: ${title}
Generated: ${new Date().toLocaleString()}
Characters: ${finalScript.length.toLocaleString()}
Words: ${Math.round(finalScript.length / 4.6).toLocaleString()}
Duration: ~${Math.round(finalScript.length / 1400)} minutes

Product: ${PRODUCT.name}
${PRODUCT.tagline}
Quality: Reference Standard (Educational Focus)
Format: ONE seamless block
Status: ‚úÖ Voice-ready, NO PRICE MENTIONS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${finalScript}`;

            const blob = new Blob([statsHeader], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            updateStatus(`üì• Downloaded: ${filename}`);
        }

        function downloadImagePrompts() {
            console.log('üì• Download image prompts clicked');
            console.log('üìù finalImagePrompts length:', finalImagePrompts ? finalImagePrompts.length : 0);

            if (!finalImagePrompts) {
                alert('No image prompts to download! Please generate a script first.');
                return;
            }

            const title = document.getElementById('videoTitle').value.trim() || 'trading_script';
            const safeTitle = title.replace(/[^a-z0-9]/gi, '_').toLowerCase().substring(0, 50);
            const filename = `image_prompts_${safeTitle}_${Date.now()}.txt`;
            console.log('üìÇ Creating file:', filename);

            const imagePromptsHeader = `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
AI IMAGE GENERATION PROMPTS
Video: ${title}
Generated: ${new Date().toLocaleString()}
Style: Trading Psychology - Stick Figure Illustrations
Total Prompts: 6 (1 Thumbnail + 5 Scene Illustrations)
Compatible With: MidJourney, DALL-E, Stable Diffusion
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${finalImagePrompts}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
USAGE INSTRUCTIONS:
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

1. Copy each individual prompt to your AI image generator
2. Thumbnail (Image 1) - Use for YouTube thumbnail
3. Images 2-6 - Use as B-roll scenes in your video
4. Maintain consistency by using all 6 images from same set
5. Adjust aspect ratios as needed (16:9 for thumbnail, flexible for scenes)

STYLE NOTES:
- All images use consistent stick figure style
- Color palette: Navy Blue (#2C3E50), Red (#E74C3C), Green (#27AE60), Orange (#F39C12)
- Professional, educational, YouTube-optimized
- Clean, minimalist, high-contrast for mobile viewing

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`;

            const blob = new Blob([imagePromptsHeader], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            updateStatus(`üé® Downloaded: ${filename}`);
        }

        document.addEventListener('DOMContentLoaded', () => {
            selectLength(60000, document.querySelector('.length-option.selected'));
        });
    </script>
</body>
</html>